/* ========== Примеры семантических ошибок для семантического анализатора (без синтаксических ошибок) ========== */

/* --- Ошибка 1: Несоответствие количества аргументов при вызове лямбды --- */
lambda (a, b) -> a + b -> two_arg_fn;
two_arg_fn(10); // СЕМАНТИЧЕСКАЯ ОШИБКА: Лямбда ожидает 2 аргумента, передан 1


/* --- Ошибка 2: Попытка вызова не-функции --- */
100 -> not_a_function;
not_a_function(5); // СЕМАНТИЧЕСКАЯ ОШИБКА: Переменная 'not_a_function' не является функцией или лямбдой


/* --- Ошибка 3: Использование необъявленной переменной внутри лямбды --- */
lambda (x) -> x + undefined_var -> bad_lambda; // СЕМАНТИЧЕСКАЯ ОШИБКА: Переменная 'undefined_var' не объявлена
                                               // ни в параметрах лямбды, ни во внешней области видимости.


/* --- Ошибка 4: Неправильное использование типов в операциях --- */
lambda (x) -> x * 2 -> func_var;
42 -> number_var;

/* СЕМАНТИЧЕСКАЯ ОШИБКА: Операция '+' не поддерживается между лямбдой и числом */
func_var + number_var -> invalid_result;

/* СЕМАНТИЧЕСКАЯ ОШИБКА: Индексация не применима к лямбда-функции */
func_var[0] -> elem;

/* СЕМАНТИЧЕСКАЯ ОШИБКА: Лямбда не может использоваться в арифметической операции */
func_var * 2 -> invalid;


/* --- Ошибка 5: Рекурсивный вызов лямбды без явного именования --- */
lambda (x) ->
    {
        if x > 0 then
            {
                /* СЕМАНТИЧЕСКАЯ ОШИБКА: Неизвестный идентификатор - лямбда не имеет имени для рекурсивного вызова */
                return recursive_lambda(x - 1);
            }
        end
        return x;
    } -> recursive_lambda;


/* --- Ошибка 6: Захват переменной, которая вышла из области видимости --- */
func create_problem_lambda()
    {
        "temporary" -> local_var;
        /* Синтаксически исправлено: write(local_var) обернуто в блок {} */
        return lambda () -> { write(local_var); };
    }
end
create_problem_lambda() -> bad_capture;
bad_capture(); // СЕМАНТИЧЕСКАЯ ОШИБКА: Обращение к уничтоженной переменной (на уровне выполнения)


/* --- Ошибка 7: Неправильный вызов встроенной функции --- */
len(10); // СЕМАНТИЧЕСКАЯ ОШИБКА: Функция 'len' ожидает список или строку, а не число.
dequeue from 100; // СЕМАНТИЧЕСКАЯ ОШИБКА: 'dequeue' применим только к спискам (очередям).


/* --- Ошибка 8: Перегрузка с одинаковой сигнатурой --- */
func duplicate(x)
    {
        return x;
    }
end
// СЕМАНТИЧЕСКАЯ ОШИБКА: Подпрограмма с именем 'duplicate' и такими же параметрами уже объявлена.
func duplicate(x)
    {
        return x * 2;
    }
end

/* --- Ошибка 9: Использование параметра out в лямбде (не поддерживается) --- */
// СЕМАНТИЧЕСКАЯ ОШИБКА: Лямбда-функции не поддерживают параметры с модификатором 'out'
lambda (x out) -> x * 2 -> invalid_lambda;


/* --- Ошибка 10: Несоответствие типов в multi-assignment --- */
lambda (x) -> x -> func_var;
100 -> num_var;

/* СЕМАНТИЧЕСКАЯ ОШИБКА: Количество переменных не соответствует количеству значений */
a, b <- func_var;

/* СЕМАНТИЧЕСКАЯ ОШИБКА: Несовместимые типы в списке присваивания */
x, y <- 10, lambda (z) -> z;


/* --- Ошибка 11: Использование лямбды в неподдерживаемой операции --- */
lambda (x) -> x -> fn1;
lambda (y) -> y + 1 -> fn2;

/* СЕМАНТИЧЕСКАЯ ОШИБКА: Операция сравнения не применима к лямбда-функциям */
if fn1 == fn2 then
    write("Functions are equal");
end

/* --- Ошибка 12: Захват неинициализированной переменной --- */
uninitialized_var; // Переменная объявлена, но не инициализирована
/* СЕМАНТИЧЕСКАЯ ОШИБКА: Захват неинициализированной переменной. */
/* Синтаксически исправлено: write(uninitialized_var) обернуто в блок {} */
lambda () -> { write(uninitialized_var); } -> problem_fn;


/* --- Ошибка 13: 'out' аргумент должен быть переменной (простым идентификатором) --- */
func process_out(x out)
    {
        100 -> x;
        return; /* Добавлен return, чтобы функция имела явный тип возврата (VOID) */
    }
end
process_out(5 + 5 out);   // СЕМАНТИЧЕСКАЯ ОШИБКА: Аргумент с модификатором 'out' должен быть переменной, а не выражением.
process_out(read() out); // СЕМАНТИЧЕСКАЯ ОШИБКА: Аргумент с модификатором 'out' должен быть переменной, а не выражением.


/* --- Ошибка 11: Оператор 'return' вне функции или лямбды --- */
return 10; // СЕМАНТИЧЕСКАЯ ОШИБКА: Оператор 'return' вне функции или лямбды.


/* --- Ошибка 11: Операторы break/continue вне цикла --- */
break;    // СЕМАНТИЧЕСКАЯ ОШИБКА: Оператор 'break' должен находиться внутри цикла.
continue; // СЕМАНТИЧЕСКАЯ ОШИБКА: Оператор 'continue' должен находиться внутри цикла.